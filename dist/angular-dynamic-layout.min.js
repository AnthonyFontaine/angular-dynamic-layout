/*
 angular-dynamic-layout 2015-07-31 
*/
!function(){"use strict";function a(a){return function(b,c,d){return a(d).assign(c,b)}}angular.module("dynamicLayout").filter("as",a)}(),function(){"use strict";function a(a){return function(b,c){return c?a.applyFilters(b,c):b}}angular.module("dynamicLayout").filter("customFilter",a)}(),function(){"use strict";function a(a){return function(b,c){return c?a.applyRankers(b,c):b}}angular.module("dynamicLayout").filter("customRanker",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(d,f){function g(){return e.layout(f[0].offsetWidth)}function h(){var b=c.defer();return a(function(){0===d.templatesToLoad&&b.resolve()}),d.$watch("templatesToLoad",function(a,c){a!==c&&0===d.templatesToLoad&&b.resolve()}),b.promise}function i(){return d.$parent}d.templatesToLoad=0,d.externalScope=i,d.$on("$includeContentRequested",function(){d.templatesToLoad++}),d.$on("$includeContentLoaded",function(){d.templatesToLoad--}),d.$watch("filteredItems",function(a,b){d.$parent.filteredItems=d.filteredItems,angular.equals(a,b)||h().then(function(){g()})},!0),angular.element(b).bind("resize",function(){d.$apply(function(){g()})}),d.$on("layout",function(a,b){g().then(function(){angular.isFunction("function")&&b()})}),h().then(function(){g()})}return{restrict:"A",scope:{items:"=",rankers:"=",filters:"=",defaulttemplate:"=?"},template:'<div                                                         class="dynamic-layout-item-parent"                        ng-repeat="it in items |                                             customFilter: filters |                                   customRanker:rankers |                                    as:this:\'filteredItems\'"                     ng-include="it.template || defaulttemplate"                 ></div>',link:f}}angular.module("dynamicLayout").directive("dynamicLayout",a)}(),function(){"use strict";function a(){function a(a,b){var c,e=[];for(c in a)d(a[c],b)&&e.push(a[c]);return e}function b(a,b){if(angular.isFunction(b))return b(a);var c=3;if(b.length<c)throw"Incorrect statement";var d=b[0],e=b[1],f=b[2];if(!a[d])return!1;switch(e){case"=":return a[d]===f;case"<":return a[d]<f;case"<=":return a[d]<=f;case">":return a[d]>f;case">=":return a[d]>=f;case"!=":return a[d]!==f;case"in":return a[d]in f;case"not in":return!(a[d]in f);case"contains":if(!(a[d]instanceof Array))throw"contains statement has to be applied on array";return a[d].indexOf(f)>-1;default:throw"Incorrect statement comparator: "+e}}function c(a,c){var d;for(d in c)if(b(a,c[d]))return!0;return!1}function d(a,b){var d;for(d in b)if(!c(a,b[d]))return!1;return!0}return{applyFilters:a}}angular.module("dynamicLayout").factory("FilterService",a)}(),function(){"use strict";function a(a){return{restrict:"A",link:function(b,c){c.bind("load error",function(){a.$broadcast("layout")})}}}angular.module("dynamicLayout").directive("layoutOnLoad",a)}(),function(){"use strict";angular.module("dynamicLayout",["ngAnimate"])}(),function(){"use strict";function a(a,b,c,d,e){function f(){r=b[0].querySelectorAll(".dynamic-layout-item-parent:not(.ng-leave)"),q=[];for(var c=0;c<r.length;++c)q.push({height:r[c].offsetHeight+parseFloat(a.getComputedStyle(r[c]).marginTop),width:r[c].children[0].offsetWidth+parseFloat(a.getComputedStyle(r[c].children[0]).marginLeft)});return q}function g(){function a(a,b){var d=c.addClass(a,"move-items-animation",{from:{position:"absolute"},to:{left:q[b].x+"px",top:q[b].y+"px"}});return d.then(function(){a.classList.remove("move-items-animation"),delete p[b]}),d}function b(){var b;for(b=0;b<q.length;++b)p[b]=a(r[b],b);e.all(p).then(function(){f.resolve()})}var f=e.defer();if(Object.keys(p).length)for(var g in p)c.cancel(p[g]),delete p[g];return d(function(){b(f)}),f.promise}function h(a){q=t.getItemsDimensionFromDOM();var b=n(),c=Math.floor(a/b);return j(c),o(b),m(s,b),t.applyToDOM()}function i(){return s}function j(a){s=[];var b;for(b=0;a>b;++b)s.push([]);return s}function k(a){var b,c=[];for(b in a){var d;if(a[b].length){var e=a[b][a[b].length-1];d=e.y+e.height}else d=0;c.push(d)}return c}function l(a,b,c){if(a.columnSpan>b.length)throw"Item too large";var d,e=0,f=0;for(d=0;d<=b.length-a.columnSpan;++d){var g=d,h=d+a.columnSpan,i=Math.max.apply(Math,b.slice(g,h));(0===d||f>i)&&(f=i,e=d)}var j=[];for(d=e;d<e+a.columnSpan;++d)j.push(d);var k={x:j[0]*c,y:f};return{columns:j,position:k}}function m(a,b){var c,d;for(c=0;c<q.length;++c){var e=k(a),f=l(q[c],e,b);for(d in f.columns)s[f.columns[d]].push(q[c]);q[c].x=f.position.x,q[c].y=f.position.y}}function n(){var a,b;for(b=0;b<q.length;++b)(!a||q[b].width<a)&&(a=q[b].width);return a}function o(a){var b;for(b=0;b<q.length;++b)q[b].columnSpan=Math.ceil(q[b].width/a)}var p={},q=[],r=[],s=[],t={getItemsDimensionFromDOM:f,applyToDOM:g,layout:h,getColumns:i};return t}angular.module("dynamicLayout").factory("PositionService",a)}(),function(){"use strict";function a(){function a(a,b){function c(a,b){return e=0,d(a,b)}function d(a,c){var f,g,h=b[e][0],i=b[e][1];if(angular.isFunction(h))f=h(a),g=h(c);else{if(h in a||h in c){if(!(h in a))return"asc"===i?-1:1;if(!(h in c))return"asc"===i?1:-1}else f=0,g=0;f=a[h],g=c[h]}if(typeof f==typeof g)if(angular.isString(f)){var j=f.localeCompare(g);if(1===j)return"asc"===i?1:-1;if(-1===j)return"asc"===i?-1:1}else{if(f>g)return"asc"===i?1:-1;if(g>f)return"asc"===i?-1:1}return++e,b.length>e?d(a,c):0}var e=0;return b&&a.sort(c),a}return{applyRankers:a}}angular.module("dynamicLayout").factory("RankerService",a)}();